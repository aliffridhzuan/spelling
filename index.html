<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>R.E.A.L Kids - Spelling â€” Mini (EN / BM / ä¸­æ–‡)</title>
<style>
  :root{--bg:#0b1020;--panel:#111935;--ink:#e9f3ff;--muted:#a9bad7;--ok:#22c55e;--no:#ef4444;--chip:#151f44;--chip-b:#253060;--accent:#60a5fa}
  html,body{height:100%} body{margin:0;background:var(--bg);color:var(--ink);font:18px/1.5 system-ui,-apple-system,Segoe UI,Roboto,Arial}
  .wrap{max-width:1000px;margin:0 auto;padding:18px;position:relative;z-index:2}

  /* tabs + chips */
  .tabs{display:flex;gap:8px;margin-bottom:10px}
  .tab{background:var(--chip);border:1px solid var(--chip-b);border-radius:999px;padding:8px 14px;font-weight:800;cursor:pointer}
  .tab[aria-pressed="true"]{background:var(--accent);color:#0a1020;border-color:#2b5fb5}
  .dates{display:flex;gap:8px;flex-wrap:wrap;margin-bottom:12px}
  .chip{background:var(--chip);border:1px solid var(--chip-b);color:var(--ink);border-radius:999px;padding:8px 12px;font-weight:700;cursor:pointer;white-space:nowrap}
  .chip.active{background:var(--accent);color:#0a1020;border-color:#2b5fb5}

  .bar{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin-bottom:10px}
  .tag{padding:6px 10px;background:#0e1632;border:1px solid var(--chip-b);border-radius:999px;color:var(--muted);font-size:12px}
  .btn{background:var(--chip);border:1px solid var(--chip-b);color:var(--ink);border-radius:12px;padding:10px 12px;font-weight:700;cursor:pointer;transition:transform 0.1s ease}
  .btn:active{transform:scale(.98)}
  .btn:disabled{opacity:0.5;cursor:not-allowed}
  .prog{height:10px;background:#0e1632;border:1px solid var(--chip-b);border-radius:999px;overflow:hidden}
  .prog>i{display:block;height:100%;background:linear-gradient(90deg,#34d399,#60a5fa);width:0%}
  .barR{margin-left:auto;display:flex;gap:10px;align-items:center}
  .star{filter:drop-shadow(0 4px 10px rgba(0,0,0,.35))}

  /* info panel (instructions) */
  .info{background:#0f1840;border:1px solid #243169;border-radius:14px;padding:10px 14px;color:#cfe1ff;margin-bottom:12px}
  .info b{color:#fff}

  /* board */
  .board{display:grid;grid-template-columns:minmax(260px,340px) 1fr;gap:14px}
  @media (max-width:900px){.board{grid-template-columns:1fr}}

  .card{background:var(--panel);border:1px solid var(--chip-b);border-radius:18px;box-shadow:0 10px 28px rgba(0,0,0,.35)}
  .clue{display:grid;place-items:center;height:340px;border-radius:18px;overflow:hidden;padding:12px}
  .clue .big{line-height:1;display:flex;flex-wrap:wrap;justify-content:center;align-items:center;gap:14px;max-width:100%;
             font-size:clamp(72px,12vw,136px);filter:drop-shadow(0 6px 16px rgba(0,0,0,.35))}
  .sun{animation:spin 18s linear infinite}@keyframes spin{to{transform:rotate(360deg)}}
  .wiggle{animation:wig 1.4s ease-in-out infinite}@keyframes wig{0%,100%{transform:rotate(-6deg)}50%{transform:rotate(6deg)}}
  .pulse{animation:pulse 1.8s ease-in-out infinite}@keyframes pulse{50%{transform:scale(1.08)}}

  .pane{padding:18px}
  h1{margin:0 0 6px;font-size:24px}
  input[type=text]{width:100%;font-size:22px;padding:12px 14px;border-radius:12px;border:1px solid var(--chip-b);background:#0d1530;color:var(--ink);outline:none}
  .row{display:flex;flex-wrap:wrap;gap:10px;align-items:center;margin-top:10px}
  .msg{min-height:30px;margin-top:10px;font-weight:800}
  .good{color:var(--ok)} .bad{color:var(--no)}
  .foot{margin-top:6px;color:var(--muted);font-size:12px}

  /* sentence / character builder */
  .builder{display:flex;flex-wrap:wrap;gap:8px;margin-top:10px}
  .piece{background:#101a3a;border:1px dashed #2a3973;color:#cfe1ff;border-radius:10px;padding:8px 12px;cursor:pointer;transition:opacity 0.2s ease}
  .piece.used{opacity:.35;pointer-events:none}

  .confetti{position:fixed;inset:0;pointer-events:none;z-index:0;display:none}
</style>
</head>
<body>
<div class="wrap">

  <!-- language tabs -->
  <div class="tabs" role="tablist" aria-label="Language">
    <button id="tab-en" class="tab" role="tab" aria-selected="true" aria-pressed="true">English (20-8-2025)</button>
    <button id="tab-ms" class="tab" role="tab" aria-selected="false" aria-pressed="false">Bahasa (22-8-2025)</button>
    <button id="tab-zh" class="tab" role="tab" aria-selected="false" aria-pressed="false">ä¸­æ–‡ (25-8-2025)</button>
  </div>

  <!-- date chips (one per language in this mini build) -->
  <div class="dates" id="dateChips"></div>

  <!-- language-specific instructions -->
  <div id="howto" class="info"></div>

  <div class="bar">
    <span class="tag">Item <b id="idx">1</b>/<b id="total">1</b></span>
    <span class="tag">Score: <b id="score">0</b> <span id="stars" class="star">â­ï¸0</span></span>
    <div class="barR">
      <label class="tag" style="cursor:pointer">
        <input type="checkbox" id="shuffle" style="vertical-align:-2px;margin-right:6px">Shuffle
      </label>
      <div class="prog" style="width:220px"><i id="bar"></i></div>
      <button id="prevBtn" class="btn">â¬… Prev</button>
      <button id="nextBtn" class="btn">Next â¡</button>
      <button id="sayBtn"  class="btn">ğŸ”Š Say</button>
      <button id="hintBtn" class="btn">ğŸ’¡ Hint</button>
      <button id="revealBtn" class="btn">ğŸ‘€ Reveal</button>
    </div>
  </div>

  <!-- board -->
  <div class="board">
    <div class="card clue" id="clueBox" aria-hidden="true"></div>

    <div class="card pane">
      <h1 id="title">Type the word</h1>
      <input id="answer" type="text" spellcheck="false" placeholder="Type your answer hereâ€¦" />
      <div id="builder" class="builder" hidden></div>
      <div class="row">
        <button id="checkBtn" class="btn">âœ… Check</button>
        <button id="clearBtn" class="btn">ğŸ§½ Clear</button>
        <button id="resetPieces" class="btn" hidden>ğŸ” Reset tiles</button>
      </div>
      <div id="msg" class="msg" aria-live="polite"></div>
      <div class="foot">Tip: Press <b>Enter</b> to check. Sentences don't need exact capitals or punctuation.</div>
    </div>
  </div>
</div>

<canvas class="confetti" id="fx"></canvas>

<script>
/* ---------------- DATA (only these 3 lessons) ---------------- */
const S = t => ({text:t, sentence:true});
const W = t => ({text:t});

/* EN 20-8-2025 */
const EN = {
  "20-8-2025": [
    W("baby"), W("key"), W("money"), W("sunny"), W("honey"),
    S("The baby likes honey."), S("Where is the key?")
  ]
};
/* BM 22-8-2025 */
const MS = {
  "22-8-2025": [
    W("surat"), W("semut"), W("sayur"), W("sijil"), W("sikat"),
    S("Semut gigit kaki saya.")
  ]
};
/* ZH 25-8-2025 (Simplified) */
const ZH = { 
  "25-8-2025": [ 
    W("è®¤"), W("è¿›"), W("è¯»"), W("çƒ"), W("æ¸©"),
    S("æˆ‘è¯»å¾ˆå¤šä¹¦ã€‚"), S("è¿™ä¸ªçƒå¾ˆæ¼‚äº®ã€‚")
  ] 
};
/* Pinyin hints for zh */
const PINYIN = { 
  "è®¤":"rÃ¨n", "è¿›":"jÃ¬n", "è¯»":"dÃº", "çƒ":"qiÃº", "æ¸©":"wÄ“n",
  "æˆ‘è¯»å¾ˆå¤šä¹¦ã€‚":"wÇ’ dÃº hÄ›n duÅ shÅ«",
  "è¿™ä¸ªçƒå¾ˆæ¼‚äº®ã€‚":"zhÃ¨ ge qiÃº hÄ›n piÃ o liang"
};

/* -------------- UI refs -------------- */
const tabEn=document.getElementById('tab-en'), tabMs=document.getElementById('tab-ms'), tabZh=document.getElementById('tab-zh');
const dateChips=document.getElementById('dateChips');
const howto=document.getElementById('howto');

const clueBox=document.getElementById('clueBox');
const titleEl=document.getElementById('title');
const ans=document.getElementById('answer');
const builder=document.getElementById('builder');
const resetPieces=document.getElementById('resetPieces');
const msg=document.getElementById('msg');
const idxEl=document.getElementById('idx'); const totalEl=document.getElementById('total');
const scoreEl=document.getElementById('score'); const starsEl=document.getElementById('stars'); const bar=document.getElementById('bar');

const prevBtn=document.getElementById('prevBtn'), nextBtn=document.getElementById('nextBtn');
const checkBtn=document.getElementById('checkBtn'), clearBtn=document.getElementById('clearBtn');
const sayBtn=document.getElementById('sayBtn'), hintBtn=document.getElementById('hintBtn'), revealBtn=document.getElementById('revealBtn');
const shuffleBox=document.getElementById('shuffle');

/* -------------- State -------------- */
let SETS = EN, voice="en-US";  // default English
let currentDate=null, list=[], i=0, score=0, stars=0;
let speechSynthesisSupported = 'speechSynthesis' in window;

/* -------------- Instructions text -------------- */
function setHowTo(lang){
  if(lang==='en'){
    howto.innerHTML =
      "<b>English:</b> Look at the clue, then <b>type the word</b> or <b>full sentence</b>. " +
      "Use <b>Say</b> to hear it, <b>Hint</b> to get the first/last word, and <b>Reveal</b> if stuck.";
  }else if(lang==='ms'){
    howto.innerHTML =
      "<b>Bahasa Melayu:</b> Tengok petunjuk, kemudian <b>taip perkataan</b> atau <b>ayat penuh</b>. " +
      "Guna <b>Say</b> untuk sebutan, <b>Hint</b> untuk klu, dan <b>Reveal</b> jika tersekat.";
  }else{
    howto.innerHTML =
      "<b>ä¸­æ–‡ï¼ˆæ™®é€šè¯ï¼‰ç»ƒä¹ ï¼š</b> ç‚¹å‡» <b>Say</b> å¬è¯»éŸ³ â†’ " +
      "å¦‚æœæ˜¯ <b>è¯è¯­</b>ï¼ˆä¸¤ä¸ªæˆ–ä»¥ä¸Šæ±‰å­—ï¼‰ï¼Œè¯·<b>ç‚¹é€‰ä¸‹é¢çš„å­—å¡</b>æ¥æ‹¼æˆè¯è¯­ï¼›" +
      "å¦‚æœæ˜¯ <b>å•å­—</b>ï¼Œå¯<b>ç›´æ¥è¾“å…¥</b>ï¼ˆæˆ–ç‚¹ <b>Reveal</b> çœ‹ç­”æ¡ˆï¼‰ã€‚" +
      "æŒ‰ <b>Hint</b> æ˜¾ç¤º<b>æ‹¼éŸ³</b>ã€‚æŒ‰ <b>Reset tiles</b> é‡æ–°æ’åˆ—å­—å¡ã€‚";
  }
}

/* -------------- Tabs -------------- */
function setLang(lang){
  if(lang==='en'){ 
    SETS=EN; 
    voice="en-US";
    tabEn.setAttribute('aria-pressed','true'); 
    tabMs.setAttribute('aria-pressed','false'); 
    tabZh.setAttribute('aria-pressed','false');
  }else if(lang==='ms'){ 
    SETS=MS; 
    voice="ms-MY";
    tabEn.setAttribute('aria-pressed','false'); 
    tabMs.setAttribute('aria-pressed','true'); 
    tabZh.setAttribute('aria-pressed','false');
  }else{ 
    SETS=ZH; 
    voice="zh-CN";
    tabEn.setAttribute('aria-pressed','false'); 
    tabMs.setAttribute('aria-pressed','false'); 
    tabZh.setAttribute('aria-pressed','true');
  }
  setHowTo(lang);
  buildDateChips();
  const first = Object.keys(SETS)[0];
  pickDate(first);
}

tabEn.addEventListener('click', () => setLang('en'));
tabMs.addEventListener('click', () => setLang('ms'));
tabZh.addEventListener('click', () => setLang('zh'));

/* -------------- Dates list (chips) -------------- */
function buildDateChips(){
  dateChips.innerHTML="";
  Object.keys(SETS).forEach(d => {
    const b=document.createElement('button');
    b.className='chip'; 
    b.textContent=d; 
    b.dataset.date=d;
    b.addEventListener('click', () => pickDate(d));
    dateChips.appendChild(b);
  });
}

function highlightDate(d){
  [...dateChips.children].forEach(c => c.classList.toggle('active', c.dataset.date === d));
}

function pickDate(d){
  currentDate=d; 
  highlightDate(d);
  list=SETS[d].slice(); 
  if(shuffleBox.checked) shuffle(list);
  i=0; 
  score=0; 
  stars=0; 
  scoreEl.textContent=score; 
  starsEl.textContent='â­ï¸'+stars;
  totalEl.textContent=list.length; 
  loadItem();
}

shuffleBox.addEventListener('change', () => { 
  if(currentDate) pickDate(currentDate); 
});

/* -------------- Item flow -------------- */
function loadItem(){
  const it = list[i];
  idxEl.textContent = i+1;
  const isZh = (SETS===ZH);
  
  // Update title based on content type
  if(it.sentence) {
    titleEl.textContent = isZh ? "Type the whole sentence" : "Type the sentence";
  } else {
    titleEl.textContent = isZh ? (it.text.length > 1 ? "Build the word" : "Type the character") : "Spell the word";
  }
  
  clueBox.innerHTML=""; 
  clueBox.appendChild(clueFor(it.text));
  ans.value=""; 
  msg.textContent=""; 
  ans.focus();
  
  // Update button states
  prevBtn.disabled = i === 0;
  nextBtn.disabled = i === list.length - 1;
  
  setupBuilder(it, isZh);
  updateBar();
}

function normalize(s){ 
  return (s||"").toLowerCase().replace(/[.,!?]/g,"").replace(/\s+/g," ").trim(); 
}

function check(){
  const it = list[i];
  const userAnswer = normalize(ans.value);
  const correctAnswer = normalize(it.text);
  const isCorrect = userAnswer === correctAnswer;
  
  if(isCorrect){
    msg.innerHTML=`âœ… <span class="good">Correct!</span> <b>${it.text}</b>`;
    score += 10; 
    scoreEl.textContent = score; 
    stars++; 
    starsEl.textContent = 'â­ï¸' + stars; 
    confetti(); 
    
    if(speechSynthesisSupported) {
      speak(voice, it.text);
    }
    
    setTimeout(() => { 
      if(i < list.length - 1){ 
        i++; 
        loadItem(); 
      } else { 
        msg.innerHTML += "<br>ğŸ‰ Great job! Lesson finished."; 
      } 
    }, 850);
  } else {
    msg.innerHTML=`âŒ <span class="bad">Try again</span> â€” hint: ${hintFor(it.text)}`;
    
    if(speechSynthesisSupported) {
      const tryAgainMsg = SETS===EN ? "Try again" : (SETS===MS ? "Cuba lagi" : "å†è¯•ä¸€æ¬¡");
      speak(voice, tryAgainMsg);
    }
  }
}

checkBtn.addEventListener('click', check);
ans.addEventListener('keydown', e => { 
  if(e.key === 'Enter') check(); 
});

clearBtn.addEventListener('click', () => { 
  ans.value = ""; 
  ans.focus(); 
  msg.textContent = ""; 
  if(!builder.hidden) markAllUnused(); 
});

prevBtn.addEventListener('click', () => { 
  if(i > 0){ 
    i--; 
    loadItem(); 
  } 
});

nextBtn.addEventListener('click', () => { 
  if(i < list.length - 1){ 
    i++; 
    loadItem(); 
  } 
});

sayBtn.addEventListener('click', () => { 
  const it = list[i]; 
  if(speechSynthesisSupported) {
    speak(voice, it.text);
  } else {
    msg.textContent = "Speech synthesis not supported in your browser";
  }
});

hintBtn.addEventListener('click', () => { 
  const it = list[i]; 
  msg.innerHTML = "ğŸ’¡ Hint: " + hintFor(it.text); 
});

revealBtn.addEventListener('click', () => { 
  const it = list[i]; 
  msg.innerHTML = "ğŸ‘€ The answer is: <b>" + it.text + "</b>"; 
});

/* -------------- Sentence / Character builder -------------- */
function wordsFromSentence(t){ 
  return t.replace(/[.?!]/g,"").split(/\s+/); 
}

function setupBuilder(it, isZh){
  let pieces = [];
  
  if(it.sentence){
    // For sentences in any language
    pieces = shuffle(wordsFromSentence(it.text));
  } else if(isZh && it.text.length > 1){
    // For Chinese words with multiple characters
    pieces = shuffle(it.text.split(""));
  } else {
    // Hide builder for single words/characters
    builder.hidden = true; 
    resetPieces.hidden = true; 
    return;
  }
  
  builder.hidden = false; 
  resetPieces.hidden = false;
  builder.innerHTML = "";
  
  pieces.forEach(word => {
    const p = document.createElement('button');
    p.className = 'piece'; 
    p.textContent = word;
    p.addEventListener('click', () => {
      if(p.classList.contains('used')) return; 
      p.classList.add('used');
      ans.value = (ans.value.trim() + " " + word).trim() + (it.sentence ? " " : ""); 
      ans.focus(); 
    });
    builder.appendChild(p);
  });
  
  resetPieces.addEventListener('click', () => { 
    ans.value = ""; 
    markAllUnused(); 
    ans.focus(); 
  });
}

function markAllUnused(){ 
  [...builder.querySelectorAll('.piece')].forEach(x => x.classList.remove('used')); 
}

/* -------------- Hints & clues -------------- */
function hintFor(text){
  if(SETS === ZH){ 
    const p = PINYIN[text]; 
    return p ? `æ‹¼éŸ³: <b>${p}</b>` : "ä¸­æ–‡æ±‰å­—"; 
  }
  
  const t = text.replace(/[.,!?]/g,"");
  
  if(t.includes(" ")){ 
    const w = t.split(/\s+/); 
    return `<b>${w[0]}</b> â€¦ <b>${w[w.length-1]}</b>`; 
  }
  
  if(t.length <= 2) return t;
  
  return `${t[0]} ${"_ ".repeat(t.length-2)} ${t[t.length-1]}`;
}

function clueFor(text){
  const t = (text || "").toLowerCase();
  const d = document.createElement('div'); 
  d.className = "big";
  
  const add = (e, cls = "") => { 
    const el = document.createElement('div'); 
    el.textContent = e; 
    el.className = "big " + cls; 
    d.appendChild(el); 
  };

  if(SETS === ZH){         /* simple icons for æ±‰å­— */
    if(text === "çƒ") add("âš½");
    else if(text === "è¯»") add("ğŸ“–");
    else if(text === "è¿›") add("â¡ï¸");
    else if(text === "æ¸©") add("ğŸŒ¡ï¸");
    else if(text === "è®¤") add("ğŸ§ ");
    else if(text.includes("ä¹¦")) add("ğŸ“š");
    else if(text.includes("æ¼‚äº®")) add("âœ¨");
    return d;
  }

  // English/Malay keywords â†’ emoji
  if(t.includes("baby")) add("ğŸ‘¶","pulse");
  if(t.includes("honey") || t.includes("madu")) add("ğŸ¯");
  if(t.includes("key") || t.includes("kunci")) add("ğŸ”‘","wiggle");
  if(t.includes("sunny") || t.includes("sun") || t.includes("matahari")) add("â˜€ï¸","sun");
  if(t.includes("money")) add("ğŸ’°");
  if(t.includes("semut") || t.includes("ant")) add("ğŸœ","wiggle");
  if(t.includes("kaki") || t.includes("leg")) add("ğŸ¦µ");
  if(t.includes("surat")) add("âœ‰ï¸");
  if(t.includes("sayur")) add("ğŸ¥¦");
  if(t.includes("sijil")) add("ğŸ“œ");
  if(t.includes("sikat")) add("ğŸ’‡â€â™€ï¸");
  if(t.includes("likes")) add("â¤ï¸","pulse");
  if(t.includes("where") || t.includes("mana")) add("â“");
  if(t.includes("gigit") || t.includes("bite")) add("ğŸ¦·");

  if(!d.childNodes.length){ 
    const el = document.createElement('div'); 
    el.textContent = text[0].toUpperCase(); 
    d.appendChild(el); 
  }
  return d;
}

/* -------------- Utils + effects -------------- */
function shuffle(a){ 
  for(let j = a.length - 1; j > 0; j--){ 
    const k = (Math.random() * (j + 1)) | 0; 
    [a[j], a[k]] = [a[k], a[j]]; 
  } 
  return a; 
}

function updateBar(){ 
  bar.style.width = ((i) / Math.max(1, (list.length - 1)) * 100) + "%"; 
}

function speak(lang, text){ 
  if(!speechSynthesisSupported) return;
  
  speechSynthesis.cancel();
  
  const u = new SpeechSynthesisUtterance(text); 
  u.lang = lang; 
  u.rate = (lang === 'zh-CN' ? 0.85 : 0.95); 
  u.pitch = 1; 
  
  speechSynthesis.speak(u); 
}

/* confetti (canvas hidden when idle so it never blocks clicks) */
const fx = document.getElementById('fx'), ctx = fx.getContext('2d'); 
let W, H; 

function resizeCanvas(){ 
  W = fx.width = innerWidth; 
  H = fx.height = innerHeight; 
} 

window.addEventListener('resize', resizeCanvas, {passive: true}); 
resizeCanvas();

function confetti(){ 
  fx.style.display = 'block'; 
  const n = 120;
  const particles = [...Array(n)].map(() => ({
    x: Math.random() * W,
    y: -10,
    vx: (Math.random() - 0.5) * 2,
    vy: 2 + Math.random() * 4,
    w: 6,
    h: 10,
    c: `hsl(${180 + Math.random() * 160} 90% 60%)`,
    a: Math.random() * Math.PI
  }));
  
  let time = 0;
  
  function loop(){
    ctx.clearRect(0, 0, W, H);
    
    particles.forEach(p => {
      p.x += p.vx;
      p.y += p.vy;
      p.a += 0.1;
      
      ctx.save();
      ctx.translate(p.x, p.y);
      ctx.rotate(p.a);
      ctx.fillStyle = p.c;
      ctx.fillRect(-p.w/2, -p.h/2, p.w, p.h);
      ctx.restore();
    }); 
    
    if((time += 16) < 900) {
      requestAnimationFrame(loop);
    } else {
      ctx.clearRect(0, 0, W, H);
      fx.style.display = 'none';
    }
  }
  
  loop();
}

/* -------------- Initialize -------------- */
document.addEventListener('DOMContentLoaded', () => {
  setLang('en'); // default language on load
  
  // Disable say button if speech synthesis isn't supported
  if(!speechSynthesisSupported) {
    sayBtn.disabled = true;
    sayBtn.title = "Text-to-speech not supported in your browser";
  }
});
</script>
</body>
</html>
